# Layer-Architecture Problems

- μ΄ κΈ€μ€ κ°€μ¥ ν”ν μ‚¬μ©λκ³  μλ” λ μ΄μ–΄λ“ μ•„ν‚¤ν…μ²μ— κ΄€ν• κΈ€μ΄λ©°, μ–΄λ–»κ² λ μ΄μ–΄λ“ μ•„ν‚¤ν…μ²λ¥Ό ν¨μ¨μ μΌλ΅ μ‚¬μ©ν•  μ μμ„κΉμ— λ€ν• ν΄λ¦¬μ¤ν‹±ν• λ‚΄μ©μ…λ‹λ‹¤.

<br>

## λ μ΄μ–΄λ“ μ•„ν‚¤ν…μ²λ€ λ¬΄μ—‡μΈκ°€?

- λ μ΄μ–΄λ“ μ•„ν‚¤ν…μ²λ€ μ•„λ κ·Έλ¦Όμ—μ„ λ³Ό μ μλ“―μ΄ λ¨λ“  μ”μ²­μ€ μ„μ—μ„ μ•„λλ΅ νλ¥΄λ” λ‹¨λ°©ν–¥ μ•„ν‚¤ν…μ²μ…λ‹λ‹¤. μ—¬κΈ°μ„ μ¤‘μ”ν• μ μ€ 'λ‹¨λ°©ν–¥' μ…λ‹λ‹¤. μμ΅΄μ„±μ΄ μ—­μ „λλ©΄ μ–‘λ°©ν–¥μ΄ λλ‹ μ£Όμκ°€ ν•„μ”ν•©λ‹λ‹¤.

![α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2024-08-07 α„‹α…©α„’α…® 10 16 05](https://github.com/user-attachments/assets/5a1753b3-8223-4c87-b5a5-5e6aa0af405d)

<br><br>

## κ³„μΈµν• Vs λ„λ©”μΈν•

#### κ³„μΈµν• λ μ΄μ–΄λ“ μ•„ν‚¤ν…μ²

- κ³„μΈµν•μ€ λ μ΄μ–΄λ“ μ•„ν‚¤ν…μ²λ¥Ό ν΄λ”μ²λΌ λ§λ“¤μ–΄μ„ μ‚¬μ©ν•λ” κ²½μ°μ…λ‹λ‹¤. μ΄λ” μ•„ν‚¤ν…μ²κ°€ μ•„λ‹™λ‹λ‹¤. λ‹¨μ κ° μ»΄ν¬λ„νΈλ“¤μ„ λ¶„λ¥μ— λ§κ² λ°°μΉν• κ²ƒμΌλΏμ…λ‹λ‹¤.
- λ¬Όλ΅ , ν”„λ΅μ νΈμ κ·λ¨κ°€ μ‘λ‹¤λ©΄ ν•΄λ‹Ή λ°©λ²•μ„ μ‚¬μ©ν•΄λ„ λκΈ΄ν•μ§€λ§ ν”„λ΅μ νΈλ” μ–Έμ  μ–΄λμκ°„μ— μ»¤μ§μ§€λ¨λ¥΄κΈ° λ•λ¬Έμ— μµμ†ν•μ λ€λΉ„μ •λ„λ” ν•΄μ•Όν•λ‹¤κ³  μƒκ°ν•©λ‹λ‹¤.

```text
β”β”€β”€ controller
β”‚   β”β”€β”€ Membercontroller
β”‚   β””β”€β”€ Postcontroller
β”β”€β”€ service
β”‚   β”β”€β”€ MemberService
β”‚   β””β”€β”€ PostService
β””β”€β”€ infrastructure
    β””β”€β”€ Aws
```

#### λ„λ©”μΈν• λ μ΄μ–΄λ“ μ•„ν‚¤ν…μ²

- λ„λ©”μΈν•μ€ λ„λ©”μΈμ„ κΈ°μ¤€μΌλ΅ λ‚λκ²ƒμ…λ‹λ‹¤.

```text
β”β”€β”€ member
β”‚   β”β”€β”€ controller
β”‚   β”β”€β”€ domain
β”‚   β”β”€β”€ dto
β”‚   β”β”€β”€ repository
β”‚   β””β”€β”€ service
β”β”€β”€ post
β”‚   β”β”€β”€ controller
β”‚   β”β”€β”€ domain
β”‚   β”β”€β”€ dto
β”‚   β”β”€β”€ repository
β”‚   β””β”€β”€ service
β”β”€β”€ global
β”‚   β”β”€β”€ exception
β”‚   β”β”€β”€ utils
β”‚   β””β”€β”€ config
β””β”€β”€ infrastructure
    β””β”€β”€ Aws
```

#### π’΅ μ¥μ 

- λ„λ©”μΈλ³„λ΅ κµ¬λ¶„μ΄ λμ–΄ μ‘μ§‘λ„λ¥Ό λ†’μΌ μ μμµλ‹λ‹¤.
- μƒλ…μ£ΌκΈ°κ°€ κ°™μ€ κ°μ²΄λ“¤μ„ λ¬¶μ„ μ μμµλ‹λ‹¤.

#### π¤” λ‹¨μ 

- λ¨νΈν• λ„λ©”μΈλ“¤μ΄ μƒκΈΈ μ μμµλ‹λ‹¤. λ¨νΈν• λ„λ©”μΈμ„ μ–΄λ””μ— μ„μΉμ‹μΌλ†”μ•Ό ν•λ”μ§€ κ³ λ―Όμ μ΄ μƒκΈ°κ²λ©λ‹λ‹¤.

<br>

## κ·Έλμ„ μ–΄λ–¤ μ•„ν‚¤ν…μ²κ°€ μΆ‹μ„κΉ?

- λ„λ©”μΈν• μ•„ν‚¤ν…μ²κ°€ μΆ‹λ‹¤κ³  λλ‚„ μ μμ§€λ§ μ‹¤μ€ λ‘ λ‹¤ μ•„λ‹™λ‹λ‹¤. λ„λ©”μΈν• μ•„ν‚¤ν…μ²μ™€ ν—¥μ‚¬κ³ λ‚  μ•„ν‚¤ν…μ²μ μ¥μ μ„ μ΅°ν•©ν•μ—¬ λ¬Έμ λ¥Ό ν•΄κ²°ν•λ©΄ μ§€μ† κ°€λ¥ν• μ†ν”„νΈμ›¨μ–΄λ¥Ό λ§λ“¤ μ μμµλ‹λ‹¤.
- DIP μ›μΉ™μ„ μ μ©ν•λ‹¤λ©΄ λ” μΆ‹μ€ μ•„ν‚¤ν…μ²λ¥Ό κ°€μ§ μ μμµλ‹λ‹¤.

#### DIP μ›μΉ™μ„ μ μ©μ‹μΌλ³΄μ

- application layerμ— μ„μΉν•κ³  μλ” Service ν΄λμ¤λ“¤μ€ JPARepositoryλ‚ Infrastructureμ— μ„μΉν•κ³  μλ” μ»΄ν¬λ„νΈλ“¤μ— μ§μ ‘μ μΌλ΅ μ ‘κ·Όν•μ§€ μ•μµλ‹λ‹¤. μ¤‘κ°„μ— μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ μ ‘κ·Όμ„ ν•κ²λ©λ‹λ‹¤.
- μ°λ¦¬κ°€ ν•΄κ²°ν•μ•Όν•λ” λ³Έμ§μ μΈ λ¬Έμ λ” λΉ„μ§€λ‹μ¤λ¥Ό μ–΄λ–»κ² ν’€μ–΄λ‚ΌκΉ? μ…λ‹λ‹¤. DIPλ¥Ό μ μ©ν•¨μΌλ΅μ¨ μ°λ¦¬λ” μ €μμ¤€ λ λ²¨μ„ μ΅°κΈμ΄μ§€λ§ λ μ‹ κ²½μ“°κ³ , λ³Έμ§μ μΈ λ¬Έμ μ— μ§‘μ¤‘ν•  μ μμµλ‹λ‹¤. λν• Service ν΄λμ¤λ¥Ό ν…μ¤νΈν•κΈ° μ„ν•΄μ„ μ¶©λ¶„ν Mockingμ„ ν•  μ μμµλ‹λ‹¤. κ·Έκ²ƒμ΄ Stubμ΄λ“  Fakeλ“  λ§μ΄μ£ .

![α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2024-08-07 α„‹α…©α„’α…® 10 35 41](https://github.com/user-attachments/assets/62b7edb7-de6a-46cb-a258-3b70923be672)

<br>

#### π¤” μ™ DIP μ›μΉ™μ„ μ μ©ν•λ”κ±ΈκΉ?

- SOLID μ›μΉ™ μ¤‘μ—μ„ μ™ DIP μ›μΉ™μ„ μ μ©ν•λ”κ±ΈκΉμ”?
- DIP μ›μΉ™μ„ μ μ©ν•¨μΌλ΅μ¨ μ„λΉ„μ¤μ— λ€ν• ν…μ¤νΈ μ½”λ“λ¥Ό μ΅°κΈ λ” μ μ—°ν•κ² κµ¬μ„±ν•  μ μμ„ λΏλ§ μ•„λ‹λΌ, μΈν”„λΌμ¤νΈλ­μ²μ— κ°•ν•κ² μμ΅΄ν•μ—¬ μ„λΉ„μ¤κ°€ μΉ¨λ²”λλ” μƒν™©μ„ λ°©μ§€ν•  μλ„ μμµλ‹λ‹¤.

<br>

#### π§ μ™ Controller - Service μ‚¬μ΄μ—λ” DIPλ¥Ό μ μ©ν•μ§€ μ•λ”κ±°μ•Ό?

- μ„ μ‚¬μ§„μ—μ„ controllerμ™€ service μ‚¬μ΄μ—λ” DIPλ¥Ό μ μ©ν•μ§€ μ•μ•μµλ‹λ‹¤. μ™ μΌκΉμ”? λ¬Όλ΅  μ•„λ κ·Έλ¦Όμ²λΌ μ μ©ν• μλ” μμ§€λ§ κ·Έλ‹¥ μ¥μ μ΄ μ—†λ‹¤κ³  μƒκ°ν•©λ‹λ‹¤.
- μ΄μ 
    1. Application λ΅μ§μ΄ λ³€κ²½λλ‹¤λ©΄ κ·Έκ²ƒμ€ μƒλ΅μ΄ μ”κµ¬μ‚¬ν•­μ…λ‹λ‹¤.
    2. DIPλ¥Ό μ μ©ν•¨μΌλ΅μ¨ λ³µμ΅μ„±λ§ μ¦κ°€λ  μ°λ ¤κ°€ μμµλ‹λ‹¤.

<img width="1032" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2024-08-07 α„‹α…©α„’α…® 10 41 45" src="https://github.com/user-attachments/assets/5f124012-e98b-4db7-86ef-fc59fd478802">

<br>
<br>

## μ •λ¦¬

- μ„ κΈ€μ λ‚΄μ©κ³Ό μμ  μ½”λ“λ¥Ό μ •λ¦¬ν•΄λ΄…μ‹λ‹¤.

```text
β””β”€β”€ src
    β”β”€β”€ main
    β”‚   β”β”€β”€ java
    β”‚   β”‚   β””β”€β”€ com
    β”‚   β”‚       β””β”€β”€ example
    β”‚   β”‚           β””β”€β”€ layer_architecture_problems
    β”‚   β”‚               β”β”€β”€ Application.java
    β”‚   β”‚               β”β”€β”€ domain
    β”‚   β”‚               β”‚   β”β”€β”€ member
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ controller
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ dao
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ domain
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ dto
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ infrastructure
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ util
    β”‚   β”‚               β”‚   β”‚    β””β”€β”€ service
    β”‚   β”‚               β”‚   β””β”€β”€ post
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ controller
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ dao
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ domain
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ dto
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ infrastructure
    β”‚   β”‚               β”‚   β”‚    β”β”€β”€ util
    β”‚   β”‚               β”‚   β”‚    β””β”€β”€ service
    β”‚   β”‚               β”β”€β”€ global
    β”‚   β”‚               β”‚   β”β”€β”€ config ----------- μ„¤μ • νμΌ
    β”‚   β”‚               β”‚   β”β”€β”€ exception -------- μμ™Έ μ²λ¦¬
    β”‚   β”‚               β”‚   β”β”€β”€ properties ------- yml λ°μ΄ν„° μμ΅΄μ„± μ£Όμ…
    β”‚   β”‚               β”‚   β””β”€β”€ utils ------------ κ³µν†µ μΏ¨λμ¤
    β”‚   β”‚               β””β”€β”€ infrastructure
    β”‚   β”‚                   β”β”€β”€ alimtalk -- κ³µν†µμΌλ΅ μ‚¬μ©λλ” μ•λ¦Όν†΅
    β”‚   β”‚                   β””β”€β”€ mailer ---- κ³µν†µμΌλ΅ μ‚¬μ©λλ” λ©”μΌ
    β”‚   β””β”€β”€ resources
    β”‚       β”β”€β”€ application-*.yml
    β”‚       β””β”€β”€ message.properties
```

--- 

## λ μ΄μ–΄λ³„ νΉμ§•

#### ~ Controller

1. μ»¨νΈλ΅¤λ¬λ” λΉ„μ§€λ‹μ¤ λ΅μ§μ„ μν–‰ν•  μ„λΉ„μ¤μ—κ² μ„μ„ν•©λ‹λ‹¤.

#### ~ Service

1. λ„λ©”μΈμ—κ² λΉ„μ§€λ‹μ¤ λ΅μ§μ„ μ„μ„ν•λ©°, μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ μ™Έλ¶€ APIμ™€ ν‘λ ¥ν•λ‹¤.
2. μ™Έλ¶€ μΈν„°νμ΄μ¤μ™€ ν†µμ‹ ν•  λ• interfaceλ¥Ό ν†µν•΄μ„λ§ μμ‚¬μ†ν†µν•λ‹¤.
    - Dao λ“±κ³Ό κ°™μ€ μΈν„°νμ΄μ¤ μ‚¬μ© 

#### ~ Dao

1. λ°μ΄ν„°λ² μ΄μ¤μ—μ„ λ„λ©”μΈμ„ μ΅°νν•  μ μλ„λ΅ λ„μ™€μ£Όλ” μΈν„°νμ΄μ¤μ…λ‹λ‹¤.

#### ~ Domain

1. λΉ„μ§€λ‹μ¤ λ΅μ§μ„ μν–‰ν•λ” λ„λ©”μΈ κ°μ²΄λ¥Ό μ •μν•λ‹¤.

#### ~ Dto

1. In/Out μ¤ν™μ„ μ •μν•λ” ν΄λμ¤λ‹¤.

#### ~ Infrastructure

1. κ° λ„λ©”μΈλ³„λ΅ λ°μ΄ν„° λ² μ΄μ¤λ¥Ό μ΅°νν•λ” ν΄λμ¤λ“¤μ΄ λ¨μ—¬μλ” κ³³μ…λ‹λ‹¤.
2. ν•΄λ‹Ή λ””λ ‰ν† λ¦¬μ— μλ” ν΄λμ¤ λ° μΈν„°νμ΄μ¤μ μ ‘κ·Ό μ ν•μλ” defaultλ΅ μ„¤μ •λ΅ μ„¤μ •ν•λ©° DAOλ¥Ό ν†µν•΄μ„λ§ μ™Έλ¶€λ΅ μ ‘κ·Όν•  μ μμµλ‹λ‹¤.

#### ~ Util

1. ν•΄λ‹Ή λ„λ©”μΈμ—μ„ κ³µν†µμ μΌλ΅ μ‚¬μ©ν•λ” ν΄λμ¤λ¥Ό μ •μν•λ‹¤.

--- 

### Global

#### ~ Config

1. μ„¤μ • νμΌμ„ μ •μν•λ‹¤.

#### ~ Exception

1. μμ™Έ μ²λ¦¬μ— κ΄€λ ¨λ ν΄λμ¤λ¥Ό μ •μν•λ‹¤.

#### ~ Properties

1. @Value μ–΄λ…Έν…μ΄μ… λ€μ‹  @ConfigurationProperties μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•μ—¬ ymlμ— μ •μλμ–΄ μλ” κ°’μ„ μ½μ–΄ μ–Ό μ μλ„λ΅ ν•λ‹¤.

#### ~ Utils

1. ν”„λ΅μ νΈμ—μ„ κ³µν†µμ μΌλ΅ μ‚¬μ©ν•λ” ν΄λμ¤λ¥Ό μ •μν•λ‹¤.

---

### Infrastructure

1. κ³µν†µμ μΌλ΅ μ‚¬μ©λλ” μ™Έλ¶€ APIμ™€ μ—°λ™ν•λ” λ¨λ“μ„ μ •μν•©λ‹λ‹¤.
2. μ„λΉ„μ¤ λ μ΄μ–΄μ—μ„λ” μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ μΈν”„λΌ μ½”λ“μ— μ ‘κ·Όν•©λ‹λ‹¤.
3. μΈν”„λΌ λ μ΄μ–΄μ μ„λΉ„μ¤ ν΄λμ¤ μ ‘κ·Ό μ ν•μλ” publicμ΄ μ•„λ‹ defaultλ΅ μ •μν•©λ‹λ‹¤.

<br><br>

#### κ°™μ΄ μ½μ–΄λ³΄λ©΄ μΆ‹μ€ κΈ€

- https://github.com/kdg0209/realizers/blob/main/%EC%9E%90%EB%B0%94%20%EC%8A%A4%ED%94%84%EB%A7%81%20%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%A5%BC%20%EC%9C%84%ED%95%9C%20%EC%8B%A4%EC%9A%A9%EC%A3%BC%EC%9D%98%20%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/10%EC%9E%A5%20%EB%8F%84%EB%A9%94%EC%9D%B8.md
- https://github.com/kdg0209/realizers/blob/main/%EC%9E%90%EB%B0%94%20%EC%8A%A4%ED%94%84%EB%A7%81%20%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%A5%BC%20%EC%9C%84%ED%95%9C%20%EC%8B%A4%EC%9A%A9%EC%A3%BC%EC%9D%98%20%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/14%EC%9E%A5%20%ED%85%8C%EC%8A%A4%ED%8A%B8%20%EB%8C%80%EC%97%AD.md
- https://kdg-is.tistory.com/entry/Layered-Architecture


